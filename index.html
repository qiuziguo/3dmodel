<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>å…³å…¬åƒ AR - å…¨å¹³å°å…¼å®¹</title>
    
    <!-- Model Viewer for fallback -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            padding: 20px;
            background: rgba(0,0,0,0.2);
        }
        
        .header h1 {
            margin: 0;
            font-size: 24px;
            color: #FFD700;
        }
        
        .ios-ar-section {
            padding: 20px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            margin: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        
        .ar-button {
            display: inline-block;
            background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
            color: white;
            text-decoration: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
            transition: all 0.3s ease;
            margin: 10px;
        }
        
        .ar-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.6);
        }
        
        .fallback-section {
            margin-top: 20px;
        }
        
        model-viewer {
            width: 100%;
            height: 400px;
            background-color: transparent;
            --poster-color: transparent;
        }
        
        .platform-info {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 15px;
            font-size: 14px;
        }
        
        .ios-only {
            display: none;
        }
        
        .non-ios {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 20px;
            }
            
            model-viewer {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ® å…³å…¬åƒ AR ä½“éªŒ</h1>
        <p id="platform-indicator">å…¨å¹³å°å…¼å®¹ç‰ˆæœ¬</p>
    </div>
    
    <!-- iOS AR Section -->
    <div class="ios-ar-section">
        <h2>ğŸ“± iOS åŸç”Ÿ AR</h2>
        <p>ä½¿ç”¨ Apple AR Quick Look æŠ€æœ¯</p>
        
        <a href="https://qiuziguo.github.io/3dmodel/einscan_pro_hd_statue_of_guan_gong/model.usdz" 
           rel="ar" 
           class="ar-button"
           id="usdz-button">
            ğŸš€ å¯åŠ¨ iOS AR ä½“éªŒ
        </a>
        
        <div class="platform-info ios-only">
            <h3>âœ… iOS è®¾å¤‡æ£€æµ‹æˆåŠŸ</h3>
            <p>â€¢ ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å³å¯ä½“éªŒåŸç”Ÿ AR</p>
            <p>â€¢ æ”¯æŒè¡¨é¢æ£€æµ‹å’Œæ‰‹åŠ¿æ§åˆ¶</p>
            <p>â€¢ æ— éœ€é¢å¤–åº”ç”¨ï¼ŒSafari ç›´æ¥æ‰“å¼€</p>
        </div>
        
        <div class="platform-info non-ios">
            <h3>ğŸ“± é’ˆå¯¹æ‚¨çš„è®¾å¤‡</h3>
            <p id="device-message">æ£€æµ‹è®¾å¤‡ç±»å‹ä¸­...</p>
        </div>
    </div>
    
    <!-- Fallback 3D Viewer -->
    <div class="fallback-section">
        <h2 style="text-align: center; margin: 20px;">ğŸ”„ 3D äº¤äº’æŸ¥çœ‹å™¨</h2>
        
        <model-viewer
            id="guan-gong-viewer"
            src="https://qiuziguo.github.io/3dmodel/einscan_pro_hd_statue_of_guan_gong/scene.gltf"
            alt="å…³å…¬åƒ 3D æ¨¡å‹"
            auto-rotate
            auto-rotate-delay="3000"
            rotation-per-second="20deg"
            camera-controls
            touch-action="pan-y"
            disable-zoom="false"
            environment-image="neutral"
            shadow-intensity="1"
            camera-orbit="0deg 75deg 2.5m"
            field-of-view="30deg"
            loading="eager">
            
            <div slot="progress-bar" style="
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: white;
                font-size: 18px;
            ">
                åŠ è½½ä¸­... â³
            </div>
        </model-viewer>
        
        <div style="text-align: center; padding: 20px; background: rgba(0,0,0,0.3); margin: 0 20px; border-radius: 10px;">
            <p><strong>3D æŸ¥çœ‹å™¨åŠŸèƒ½ï¼š</strong></p>
            <p>ğŸ”„ æ‹–æ‹½æ—‹è½¬ â€¢ ğŸ“ åŒæŒ‡ç¼©æ”¾ â€¢ â¯ï¸ è‡ªåŠ¨æ—‹è½¬</p>
        </div>
    </div>

    <script>
        // Device detection
        function isIOS() {
            return /iPad|iPhone|iPod/.test(navigator.userAgent);
        }
        
        function isAndroid() {
            return /Android/.test(navigator.userAgent);
        }
        
        function supportsARQuickLook() {
            const a = document.createElement('a');
            return a.relList && a.relList.supports && a.relList.supports('ar');
        }
        
        function supportsWebXR() {
            return 'xr' in navigator;
        }
        
        // Update UI based on device
        function updateDeviceUI() {
            const platformIndicator = document.getElementById('platform-indicator');
            const deviceMessage = document.getElementById('device-message');
            const iosOnlyElements = document.querySelectorAll('.ios-only');
            const nonIosElements = document.querySelectorAll('.non-ios');
            
            if (isIOS()) {
                platformIndicator.textContent = 'iOS è®¾å¤‡ - åŸç”Ÿ AR æ”¯æŒ';
                iosOnlyElements.forEach(el => el.style.display = 'block');
                nonIosElements.forEach(el => el.style.display = 'none');
                
                if (supportsARQuickLook()) {
                    deviceMessage.innerHTML = 'âœ… æ”¯æŒ iOS AR Quick Look<br>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®ä½“éªŒåŸç”Ÿ AR';
                } else {
                    deviceMessage.innerHTML = 'âš ï¸ éœ€è¦ iOS 12+ å’Œ Safari æµè§ˆå™¨';
                }
            } else if (isAndroid()) {
                platformIndicator.textContent = 'Android è®¾å¤‡';
                deviceMessage.innerHTML = isAndroid() && supportsWebXR() ? 
                    'ğŸ¤– Android è®¾å¤‡æ£€æµ‹åˆ°<br>ğŸ¯ <a href="./index.html" style="color: #4CAF50;">ç‚¹å‡»è¿™é‡Œä½“éªŒ WebXR AR</a>' :
                    'ğŸ¤– Android è®¾å¤‡æ£€æµ‹åˆ°<br>ğŸ“± ä½¿ç”¨ä¸‹æ–¹ 3D æŸ¥çœ‹å™¨æˆ–å°è¯• Chrome æµè§ˆå™¨çš„ WebXR åŠŸèƒ½';
            } else {
                platformIndicator.textContent = 'æ¡Œé¢è®¾å¤‡';
                deviceMessage.innerHTML = 'ğŸ’» æ¡Œé¢è®¾å¤‡æ£€æµ‹åˆ°<br>ğŸ“± ä½¿ç”¨ä¸‹æ–¹ 3D æŸ¥çœ‹å™¨æŸ¥çœ‹æ¨¡å‹';
            }
        }
        
        // Handle USDZ button click
        document.getElementById('usdz-button').addEventListener('click', function(e) {
            if (!isIOS()) {
                e.preventDefault();
                if (isAndroid()) {
                    alert('Android è®¾å¤‡è¯·ä½¿ç”¨ä¸‹æ–¹çš„ 3D æŸ¥çœ‹å™¨ï¼Œæˆ–è®¿é—® WebXR ç‰ˆæœ¬ä½“éªŒ AR');
                } else {
                    alert('æ­¤ AR åŠŸèƒ½éœ€è¦åœ¨ iOS è®¾å¤‡ï¼ˆiPhone/iPadï¼‰ä¸Šä½¿ç”¨');
                }
                return;
            }
            
            if (!supportsARQuickLook()) {
                e.preventDefault();
                alert('éœ€è¦ iOS 12+ å’Œ Safari æµè§ˆå™¨æ”¯æŒ AR Quick Look');
                return;
            }
        });
        
        // Initialize
        window.addEventListener('load', updateDeviceUI);
        
        // Model viewer events
        const modelViewer = document.querySelector('#guan-gong-viewer');
        
        modelViewer.addEventListener('load', () => {
            console.log('3D æ¨¡å‹åŠ è½½æˆåŠŸ');
        });
        
        modelViewer.addEventListener('error', (error) => {
            console.error('æ¨¡å‹åŠ è½½å¤±è´¥:', error);
        });
    </script>
</body>
</html>
